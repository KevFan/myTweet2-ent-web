{{#if isAdmin}}
  {{> menuAdmin _id='dashboard'}}
{{else}}
  {{> menuUser _id="dashboard"}}
{{/if}}

<!--https://www.w3schools.com/graphics/google_maps_overlays.asp-->
<div id="map" class="ui segment" style="width:100%;height:200px"></div>

<script>
  function myMap() {
    const defaultCoords = new google.maps.LatLng(52.2474841,-7.1832407);
    const mapCanvas = document.getElementById("map");
    const mapOptions = {center: defaultCoords, zoom: 8};
    const map = new google.maps.Map(mapCanvas, mapOptions);
    {{#if tweets}}
      {{#each tweets}}
        var myCenter = new google.maps.LatLng({{marker.coords.latitude}},{{marker.coords.longitude}});
        var marker = new google.maps.Marker({position: myCenter });
        marker.setMap(map);
      {{/each}}
    {{/if}}
  }
</script>

<script src="https://maps.googleapis.com/maps/api/js?key={{mapKey}}&callback=myMap"></script>

<section class="ui stackable grid">
  <aside class="ui center aligned four wide column">
    <div class="ui segment">
      {{#if user.image}}
        <img class="ui middle aligned circular medium image" src="{{user.image}}">
      {{else}}
        <i class="massive user icon"></i>
      {{/if}}
      <p>{{user.firstName}} {{user.lastName}}</p>
      <p>{{user.email}}</p>
      {{#if isCurrentUser}}
        <form action="/updateProfilePicture" method="post" enctype="multipart/form-data" style="display:inline">
          <label for="file" class="circular ui icon blue button">
            <i class="file image outline icon"></i></label>
          <input type="file" id="file" name="image" style="display:none">
          <button class="circular ui icon green button">
            <i class="cloud upload icon"></i>
          </button>
        </form>
        <a class="circular ui icon red button" href="/deleteProfilePicture">
          <i class="delete icon"></i></a>
      {{/if}}
    </div>
    <div class="ui segment">
      <p>Followers</p>
        {{#each followers}}
          <a href="/view/{{follower._id}}" data-tooltip="{{follower.firstName}} {{follower.lastName}}">
            {{#if follower.image}}
              <img class="ui avatar image" src="{{follower.image}}">
            {{else}}
              <img class="ui avatar image" src="/images/user.png">
            {{/if}}
          </a>
        {{/each}}
    </div>
    <div class="ui segment">
      <p>Following</p>
      {{#each following}}
        <a href="/view/{{following._id}}" data-tooltip="{{following.firstName}} {{following.lastName}}">
          {{#if following.image}}
            <img class="ui avatar image" src="{{following.image}}">
          {{else}}
            <img class="ui avatar image" src="/images/user.png">
          {{/if}}
        </a>
      {{/each}}
    </div>
  </aside>
  <div class="ui twelve wide column">
      <div class="ui center aligned basic segment">
        {{#if isCurrentUser}}
          <button class="circular ui icon blue button item" data-modal="addTweet">
            <i class="plus icon"></i>
          </button>
          <a href="/deleteAllUserTweets/{{user._id}}">
            <button class="circular ui icon red button">
              <i class="trash icon"></i>
            </button>
          </a>
        {{else}}
          <form action="/follow" method="POST" style="display: inline;">
            <button name="following" value="{{user._id}}" class="circular ui icon teal button item">
              <i class="add user icon"></i>
            </button>
          </form>
          <a href="/follow/{{user._id}}">
            <button class="circular ui icon red button item">
              <i class="remove user icon"></i>
            </button>
          </a>
        {{/if}}
      </div>
    {{> listTweets}}
  </div>
</section>

{{> addTweet}}